
# Проектная работа: Предсказание магнитуды возможных землетрясений на территории Японии
## Введение

### 1.1 Аналитический обзор предметной области
Землетрясения – это естественные катастрофы, которые могут привести к серьезным разрушениям и угрозам для жизни. Предсказание магнитуды землетрясений становится важным элементом сейсмологических исследований с целью предоставления предупреждений и подготовки к возможным последствиям.

Целью задачи является разработка модели машинного обучения, способной предсказывать магнитуду землетрясения на основе имеющихся данных о сейсмической активности. Это позволит улучшить понимание сейсмических процессов и повысить эффективность систем предупреждения.

Для построения модели требуется обширный набор данных о землетрясениях, включающий в себя характеристики сейсмической активности (глубина, время, местоположение), геологические и геофизические параметры, также исторические данные о предшествующих землетрясениях.

*Характеристики модели*:
1. Выбор алгоритма: Множество алгоритмов машинного обучения может быть использовано, включая регрессию, случайные леса, градиентный бустинг и нейронные сети.

2. Признаки (Features): Определение наиболее важных признаков, влияющих на магнитуду землетрясения, таких как глубина фокуса, расстояние от эпицентра, характеристики геологического состава и др.

3. Обработка данных: Предварительная обработка данных включает в себя заполнение пропущенных значений, нормализацию, а также возможно, создание новых признаков из имеющихся данных.

4. Метрики оценки: Оценка модели может проводиться с использованием метрик, таких как среднеквадратичная ошибка (MSE) или средняя абсолютная ошибка (MAE), чтобы измерить точность предсказаний.

*Проблемы и вызовы*:

1. Неопределенность данных: Сейсмологические данные часто подвержены неопределенности, что делает задачу предсказания более сложной.

2. Редкость событий: Землетрясения являются редкими событиями, что может привести к дисбалансу классов и требовать специального внимания при обучении модели.

3. Интерпретация результатов: Понимание того, какие факторы действительно влияют на магнитуду землетрясения, может быть сложной задачей, особенно в контексте сложных геологических процессов.

Разработка модели предсказания магнитуды землетрясений требует глубокого понимания сейсмологии и применение передовых методов машинного обучения. Такие модели могут стать мощным инструментом для сейсмологов и гражданских защитников, предоставляя более эффективные инструменты для управления рисками и борьбы с последствиями землетрясений.

### 1.2 Обзор методов машинного обучения для задачи предсказания магнитуды землетрясения
1. Линейная регрессия:
Описание: Простой и понятный метод, предполагающий линейную зависимость между входными признаками и магнитудой землетрясения.

Применение: Эффективен, когда зависимости между признаками и целевой переменной линейны.

2. Метод опорных векторов (Support Vector Machines - SVM):
Описание: Ищет гиперплоскость, максимально разделяющую данные, что полезно в случае нелинейных зависимостей.

Применение: Эффективен при наличии нелинейных взаимосвязей в данных.

3. Случайные леса (Random Forests):
Описание: Ансамбль деревьев решений, обученных на случайных подмножествах данных. Обеспечивает хорошую обобщающую способность.

Применение: Эффективен в случаях, когда в данных есть сложные взаимосвязи.

4. Градиентный бустинг (Gradient Boosting):
Описание: Строит последовательность моделей, каждая из которых исправляет ошибки предыдущей. XGBoost и LightGBM - популярные варианты градиентного бустинга.

Применение: Обладает высокой точностью и может хорошо работать с разнородными данными.

5. Нейронные сети:
Описание: Глубокие нейронные сети могут обнаруживать сложные нелинейные зависимости в данных. Рекуррентные нейронные сети (RNN) могут использоваться для учета временных зависимостей.

Применение: Требует большого объема данных, но может обеспечить высокую точность при правильной настройке.

6. Концепция временных рядов:
Описание: Использует информацию о времени для моделирования изменений в сейсмической активности.
Применение: Эффективен, когда временные факторы играют важную роль.

7. Методы глубокого обучения для обработки текста и изображений:
Описание: Использование методов глубокого обучения для анализа сейсмических изображений или текстовой информации.

Применение: Может быть полезен при анализе визуальных данных или текстовых описаний сейсмической активности.

8. Анализ временных рядов и спектральные методы:
Описание: Включают в себя методы анализа частот, такие как преобразование Фурье, для выделения периодичных закономерностей в сейсмических данных.

Применение: Может быть полезен для выявления циклических паттернов в данных.

**Исходя из вышеперечисленной информации и моего первичного исследования имеющихся данных, мой выбор пал на модель случайного леса, вот ее основные преимущества:**
1. *Устойчивость к переобучению:*
Random Forest имеет встроенные механизмы борьбы с переобучением, такие как случайный выбор подмножества данных и признаков для обучения каждого дерева. Это делает метод более устойчивым к переобучению нашей модели на конкретных данных, что особенно важно в случае ограниченного объема данных о землетрясениях.

2. *Обработка разнородных данных:*
Random Forest хорошо справляется с разнородными данными, включая числовые и категориальные признаки. Это полезно при использовании различных типов данных, таких как геологические параметры, временные ряды и географические координаты.

3. *Высокая точность:*
Ансамбль деревьев решений в Random Forest позволяет создать сильный и устойчивый классификатор. Это преимущество в задаче, где важно достичь высокой точности предсказаний, чтобы эффективно предотвращать возможные последствия землетрясений.

4. *Способность работать с большим количеством признаков:*
Random Forest обычно хорошо справляется с большим числом признаков, что важно, учитывая множество параметров, влияющих на землетрясения. Это также позволяет модели обнаруживать сложные взаимосвязи между различными факторами.

5. *Обработка нелинейных зависимостей:*
Random Forest способен моделировать нелинейные зависимости между признаками и целевой переменной, что может быть критично в случае сложных физических процессов, связанных с землетрясениями.

6. *Важность признаков:*
Метод предоставляет информацию о важности каждого признака в процессе принятия решения. Это может быть полезно для сейсмологов в понимании того, какие факторы оказывают значительное воздействие на магнитуду землетрясений.

## Программная реализация
### 2.1 Разработка и обучение модели
В ходе работы я использовала различные библиотеки, как саму реализацию Random Forest, так и библиотеки для предварительной обработки данных, а так же помогающие оценить эффективность обученной модели. Подробная работа описана в файлах ниже:
1. [Отчет 2. Предварительно исследование датасета](https://colab.research.google.com/drive/1JLSqjhaD10PhQrkhsBpm2qWyQuPTapYF?usp=sharing)
2. [Отчет 3. Проведение анализа на этапе изучения (EDA), поиск закономерностей, выбор подходящего алгоритма ](https://colab.research.google.com/drive/1x3fKu-VA1lFh1sKsOlKtuadsTjTHvs6C?usp=sharing)
3. [Отчет 4. Построение модели](https://colab.research.google.com/drive/1tHhc_XtbSWPKwbpDU3R7FxDxbpmT2Tjh?usp=sharing)
4. [Обученная модель](../Japan earthquakes 2001 - 2018.csv)

### 2.2 Разработка визуализации работы модели
Наиболее подходящим способом визуализации работы модели, мной был определен Телеграм Бот, на основе современной библиотеки Aiogram3. Основными факторами в пользу телеграм бота были его доступность, быстрый доступ, возможность отправки экстренных сообщений.

[Описание работы](https://colab.research.google.com/drive/1cJfM3IfWagVcDl1CffsX3FL9KN5DJSnT#scrollTo=6uGL8gxt2xIG)

###  2.3 Описание запуска телеграм бота
Для запуска бота необходимо зайти в приложение main.py и запустить его с помощью плагина Code Runner для VS Code, или же использовать команду ```python main.py``` в командной строке

## Заключение
В ходе работы я изучила большое количество информации о сейсмической активности в регионе Японии. Для точного прогнозирования даты ближайшего землетрясения у человечества еще слишком мало информации о самом феномене землетрясений. Но моя модель прогнозирования магнитуды показала хороший результат на тестовых данных, что так же продвигает нас в области изучения сейсмологии и способности предотвращать большие трагедии от землетрясений.




